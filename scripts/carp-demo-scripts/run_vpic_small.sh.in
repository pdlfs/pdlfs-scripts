#!/usr/bin/env bash

# simple VPIC demonstration script
# assumes mpich flavor of MPI is available, and single node can run 32 threads

VPIC_BIN=@CMAKE_INSTALL_PREFIX@/decks/reconnection.Linux
VPIC_PWD=/tmp/carp-demo/vpic-trace-small

mkdir -p $VPIC_PWD
cd $VPIC_PWD

# run VPIC, small scale. should be doable on a smaller cluster
mpirun -np 32 $VPIC_BIN

# $VPIC_PWD/particle is converted into particle.compressed
# by following these steps:
# - each particle is parsed to populate a particle struct
# - particle struct has ux, uy, uz (momentum in x/y/z)
# - energy is computed using E = sqrt(1 + px^2 + py^2 + pz^2) - 1
# refer to scripts/gen_compressed_trace.py for the full workflow
